<?php

namespace App\Services\Covepa;

use Carbon\Carbon;
use App\Models\Order;

class Helpers {

    /**
     * Mapeo con el tipo de pago con Covepa
     * 10 - transferencia
     * 15 - tarjeta credito
     * 26 - tarjeta debito
     */
    const TYPE_PAYMENT_MAPPING = [
        'VD' => 26,
        'VN' => 15,
        'VC' => 15,
        'SI' => 15,
        'S2' => 15,
        'NC' => 15,
        'VP' => 15,
    ];

    /**
     * Mapeo entre el ID de las comunas en SimpleGestion y el ID en Covepa
     * 
     * id_comuna_simple => id_covepa
     */
    const COMMUNE_MAPPING = [
        1 => ['id_commune' => 9, 'id_city' => 110],
        2 => ['id_commune' => 53, 'id_city' => 402],
        3 => ['id_commune' => 8, 'id_city' => 115],
        4 => ['id_commune' => 6, 'id_city' => 75],
        5 => ['id_commune' => 11, 'id_city' => 94],
        6 => ['id_commune' => 7, 'id_city' => 150],
        7 => ['id_commune' => 10, 'id_city' => 325],
        8 => ['id_commune' => 19, 'id_city' => 65],
        9 => ['id_commune' => 18, 'id_city' => 132],
        10 => ['id_commune' => 17, 'id_city' => 379],
        11 => ['id_commune' => 20, 'id_city' => 189],
        12 => ['id_commune' => 15, 'id_city' => 70],
        13 => ['id_commune' => '#N/A', 'id_city' => '#N/A'],
        14 => ['id_commune' => 16, 'id_city' => 179],
        15 => ['id_commune' => 12, 'id_city' => 191],
        16 => ['id_commune' => 13, 'id_city' => 130],
        17 => ['id_commune' => 24, 'id_city' => 13],
        18 => ['id_commune' => 23, 'id_city' => 71],
        19 => ['id_commune' => 25, 'id_city' => 382],
        20 => ['id_commune' => 22, 'id_city' => 80],
        21 => ['id_commune' => 21, 'id_city' => 103],
        22 => ['id_commune' => 28, 'id_city' => 196],
        23 => ['id_commune' => 29, 'id_city' => 403],
        24 => ['id_commune' => 27, 'id_city' => 104],
        25 => ['id_commune' => 26, 'id_city' => 109],
        26 => ['id_commune' => 31, 'id_city' => 49],
        27 => ['id_commune' => 34, 'id_city' => 14],
        28 => ['id_commune' => 35, 'id_city' => 63],
        29 => ['id_commune' => 30, 'id_city' => 252],
        30 => ['id_commune' => '#N/A', 'id_city' => '#N/A'],
        31 => ['id_commune' => 32, 'id_city' => 199],
        32 => ['id_commune' => 42, 'id_city' => 58],
        33 => ['id_commune' => 344, 'id_city' => 214],
        34 => ['id_commune' => 44, 'id_city' => 128],
        35 => ['id_commune' => 43, 'id_city' => 365],
        36 => ['id_commune' => 37, 'id_city' => 138],
        37 => ['id_commune' => 40, 'id_city' => 87],
        38 => ['id_commune' => 38, 'id_city' => 295],
        39 => ['id_commune' => 39, 'id_city' => 336],
        40 => ['id_commune' => 36, 'id_city' => 360],
        41 => ['id_commune' => 72, 'id_city' => 55],
        42 => ['id_commune' => 74, 'id_city' => 219],
        43 => ['id_commune' => 75, 'id_city' => 89],
        44 => ['id_commune' => 73, 'id_city' => 176],
        45 => ['id_commune' => 67, 'id_city' => 330],
        46 => ['id_commune' => 68, 'id_city' => 167],
        47 => ['id_commune' => 69, 'id_city' => 56],
        48 => ['id_commune' => 76, 'id_city' => 111],
        49 => ['id_commune' => 63, 'id_city' => 126],
        50 => ['id_commune' => 65, 'id_city' => 210],
        51 => ['id_commune' => 64, 'id_city' => 358],
        52 => ['id_commune' => 66, 'id_city' => 368],
        53 => ['id_commune' => 48, 'id_city' => 114],
        54 => ['id_commune' => 46, 'id_city' => 481],
        55 => ['id_commune' => 47, 'id_city' => 141],
        56 => ['id_commune' => 45, 'id_city' => 322],
        57 => ['id_commune' => 49, 'id_city' => 206],
        58 => ['id_commune' => 60, 'id_city' => 347],
        59 => ['id_commune' => 57, 'id_city' => 249],
        60 => ['id_commune' => 58, 'id_city' => 244],
        61 => ['id_commune' => 59, 'id_city' => 250],
        62 => ['id_commune' => 56, 'id_city' => 302],
        63 => ['id_commune' => 81, 'id_city' => 173],
        64 => ['id_commune' => 77, 'id_city' => 61],
        65 => ['id_commune' => 80, 'id_city' => 77],
        66 => ['id_commune' => 78, 'id_city' => 234],
        67 => ['id_commune' => 79, 'id_city' => 116],
        68 => ['id_commune' => 82, 'id_city' => 171],
        69 => ['id_commune' => 52, 'id_city' => 174],
        70 => ['id_commune' => 54, 'id_city' => 220],
        71 => ['id_commune' => '#N/A', 'id_city' => '#N/A'],
        72 => ['id_commune' => 217, 'id_city' => 314],
        73 => ['id_commune' => 50, 'id_city' => 343],
        74 => ['id_commune' => 51, 'id_city' => 378],
        75 => ['id_commune' => 71, 'id_city' => 41],
        76 => ['id_commune' => 62, 'id_city' => 488],
        77 => ['id_commune' => 61, 'id_city' => 308],
        78 => ['id_commune' => 70, 'id_city' => 396],
        79 => ['id_commune' => 87, 'id_city' => 46],
        80 => ['id_commune' => 84, 'id_city' => 88],
        81 => ['id_commune' => '#N/A', 'id_city' => '#N/A'],
        82 => ['id_commune' => 92, 'id_city' => 158],
        83 => ['id_commune' => 89, 'id_city' => 100],
        84 => ['id_commune' => 85, 'id_city' => 242],
        85 => ['id_commune' => 94, 'id_city' => 101],
        86 => ['id_commune' => 86, 'id_city' => 95],
        87 => ['id_commune' => 98, 'id_city' => 142],
        88 => ['id_commune' => 83, 'id_city' => 298],
        89 => ['id_commune' => 88, 'id_city' => 306],
        90 => ['id_commune' => 96, 'id_city' => 323],
        91 => ['id_commune' => 97, 'id_city' => 326],
        92 => ['id_commune' => 93, 'id_city' => 348],
        93 => ['id_commune' => 95, 'id_city' => 352],
        94 => ['id_commune' => 90, 'id_city' => 353],
        95 => ['id_commune' => '#N/A', 'id_city' => '#N/A'],
        96 => ['id_commune' => 103, 'id_city' => 146],
        97 => ['id_commune' => 101, 'id_city' => 251],
        98 => ['id_commune' => 104, 'id_city' => 259],
        99 => ['id_commune' => 353, 'id_city' => 484],
        100 => ['id_commune' => 100, 'id_city' => 156],
        101 => ['id_commune' => '#N/A', 'id_city' => '#N/A'],
        102 => ['id_commune' => 106, 'id_city' => 175],
        103 => ['id_commune' => 114, 'id_city' => 81],
        104 => ['id_commune' => 109, 'id_city' => 83],
        105 => ['id_commune' => 115, 'id_city' => 261],
        106 => ['id_commune' => 111, 'id_city' => 300],
        107 => ['id_commune' => 110, 'id_city' => 312],
        108 => ['id_commune' => 107, 'id_city' => 320],
        109 => ['id_commune' => 108, 'id_city' => 328],
        110 => ['id_commune' => 113, 'id_city' => 335],
        111 => ['id_commune' => 112, 'id_city' => 182],
        112 => ['id_commune' => 128, 'id_city' => 52],
        113 => ['id_commune' => 131, 'id_city' => 90],
        114 => ['id_commune' => 126, 'id_city' => 231],
        115 => ['id_commune' => 133, 'id_city' => 238],
        116 => ['id_commune' => 132, 'id_city' => 29],
        117 => ['id_commune' => 127, 'id_city' => 317],
        118 => ['id_commune' => 129, 'id_city' => 319],
        119 => ['id_commune' => 125, 'id_city' => 359],
        120 => ['id_commune' => 130, 'id_city' => 367],
        121 => ['id_commune' => 134, 'id_city' => 376],
        122 => ['id_commune' => 145, 'id_city' => 485],
        123 => ['id_commune' => 143, 'id_city' => 221],
        124 => ['id_commune' => 144, 'id_city' => 84],
        125 => ['id_commune' => 119, 'id_city' => 98],
        126 => ['id_commune' => 121, 'id_city' => 245],
        127 => ['id_commune' => 124, 'id_city' => 258],
        128 => ['id_commune' => 123, 'id_city' => 294],
        129 => ['id_commune' => 118, 'id_city' => 350],
        130 => ['id_commune' => 117, 'id_city' => 363],
        131 => ['id_commune' => 120, 'id_city' => 364],
        132 => ['id_commune' => 116, 'id_city' => 380],
        133 => ['id_commune' => 122, 'id_city' => 197],
        134 => ['id_commune' => 139, 'id_city' => 121],
        135 => ['id_commune' => 136, 'id_city' => 79],
        136 => ['id_commune' => 140, 'id_city' => 263],
        137 => ['id_commune' => 142, 'id_city' => 316],
        138 => ['id_commune' => 141, 'id_city' => 354],
        139 => ['id_commune' => 135, 'id_city' => 372],
        140 => ['id_commune' => 137, 'id_city' => 200],
        141 => ['id_commune' => 138, 'id_city' => 205],
        142 => ['id_commune' => 171, 'id_city' => 12],
        143 => ['id_commune' => 173, 'id_city' => 159],
        144 => ['id_commune' => 176, 'id_city' => 222],
        145 => ['id_commune' => 168, 'id_city' => 239],
        146 => ['id_commune' => 172, 'id_city' => 246],
        147 => ['id_commune' => 174, 'id_city' => 267],
        148 => ['id_commune' => 169, 'id_city' => 144],
        149 => ['id_commune' => 177, 'id_city' => 375],
        150 => ['id_commune' => 175, 'id_city' => 183],
        151 => ['id_commune' => 170, 'id_city' => 51],
        152 => ['id_commune' => 167, 'id_city' => 192],
        153 => ['id_commune' => 346, 'id_city' => 73],
        154 => ['id_commune' => 194, 'id_city' => 118],
        155 => ['id_commune' => 191, 'id_city' => 66],
        156 => ['id_commune' => 195, 'id_city' => 76],
        157 => ['id_commune' => 196, 'id_city' => 91],
        158 => ['id_commune' => 192, 'id_city' => 229],
        159 => ['id_commune' => 193, 'id_city' => 265],
        160 => ['id_commune' => 197, 'id_city' => 166],
        161 => ['id_commune' => 185, 'id_city' => 59],
        162 => ['id_commune' => 181, 'id_city' => 404],
        163 => ['id_commune' => 178, 'id_city' => 405],
        164 => ['id_commune' => 183, 'id_city' => 113],
        165 => ['id_commune' => 190, 'id_city' => 299],
        166 => ['id_commune' => 186, 'id_city' => 135],
        167 => ['id_commune' => 187, 'id_city' => 86],
        168 => ['id_commune' => 189, 'id_city' => 344],
        169 => ['id_commune' => 184, 'id_city' => 345],
        170 => ['id_commune' => 182, 'id_city' => 180],
        171 => ['id_commune' => 188, 'id_city' => 377],
        172 => ['id_commune' => 180, 'id_city' => 393],
        173 => ['id_commune' => 179, 'id_city' => 397],
        174 => ['id_commune' => 315, 'id_city' => 401],
        175 => ['id_commune' => 155, 'id_city' => 10],
        176 => ['id_commune' => 159, 'id_city' => 207],
        177 => ['id_commune' => 146, 'id_city' => 225],
        178 => ['id_commune' => 158, 'id_city' => 226],
        179 => ['id_commune' => 154, 'id_city' => 227],
        180 => ['id_commune' => 166, 'id_city' => 223],
        181 => ['id_commune' => 163, 'id_city' => 232],
        182 => ['id_commune' => 151, 'id_city' => 301],
        183 => ['id_commune' => '#N/A', 'id_city' => '#N/A'],
        184 => ['id_commune' => 164, 'id_city' => 318],
        185 => ['id_commune' => 157, 'id_city' => 149],
        186 => ['id_commune' => 156, 'id_city' => 329],
        187 => ['id_commune' => 162, 'id_city' => 346],
        188 => ['id_commune' => 150, 'id_city' => 349],
        189 => ['id_commune' => 161, 'id_city' => 137],
        190 => ['id_commune' => 149, 'id_city' => 366],
        191 => ['id_commune' => 148, 'id_city' => 369],
        192 => ['id_commune' => 160, 'id_city' => 371],
        193 => ['id_commune' => 153, 'id_city' => 374],
        194 => ['id_commune' => 152, 'id_city' => 400],
        195 => ['id_commune' => 165, 'id_city' => 398],
        196 => ['id_commune' => 213, 'id_city' => 53],
        197 => ['id_commune' => 214, 'id_city' => 215],
        198 => ['id_commune' => 218, 'id_city' => 162],
        199 => ['id_commune' => 226, 'id_city' => 230],
        200 => ['id_commune' => 219, 'id_city' => 483],
        201 => ['id_commune' => 210, 'id_city' => 240],
        202 => ['id_commune' => 222, 'id_city' => 241],
        203 => ['id_commune' => 211, 'id_city' => 24],
        204 => ['id_commune' => 227, 'id_city' => 262],
        205 => ['id_commune' => 215, 'id_city' => 293],
        206 => ['id_commune' => 216, 'id_city' => 304],
        207 => ['id_commune' => 228, 'id_city' => 53],
        208 => ['id_commune' => 209, 'id_city' => 321],
        209 => ['id_commune' => 220, 'id_city' => 475],
        210 => ['id_commune' => 223, 'id_city' => 155],
        211 => ['id_commune' => 102, 'id_city' => 334],
        212 => ['id_commune' => 221, 'id_city' => 381],
        213 => ['id_commune' => 225, 'id_city' => 389],
        214 => ['id_commune' => 212, 'id_city' => 395],
        215 => ['id_commune' => 224, 'id_city' => 203],
        216 => ['id_commune' => 345, 'id_city' => 224],
        217 => ['id_commune' => 199, 'id_city' => 64],
        218 => ['id_commune' => 200, 'id_city' => 482],
        219 => ['id_commune' => 207, 'id_city' => 168],
        220 => ['id_commune' => 203, 'id_city' => 139],
        221 => ['id_commune' => 208, 'id_city' => 264],
        222 => ['id_commune' => 201, 'id_city' => 266],
        223 => ['id_commune' => 204, 'id_city' => 268],
        224 => ['id_commune' => 202, 'id_city' => 342],
        225 => ['id_commune' => 198, 'id_city' => 351],
        226 => ['id_commune' => 206, 'id_city' => 392],
        227 => ['id_commune' => 205, 'id_city' => 198],
        228 => ['id_commune' => 1, 'id_city' => 1],
        229 => ['id_commune' => 253, 'id_city' => 6],
        230 => ['id_commune' => 254, 'id_city' => 419],
        231 => ['id_commune' => 248, 'id_city' => 20],
        232 => ['id_commune' => 247, 'id_city' => 21],
        233 => ['id_commune' => 251, 'id_city' => 30],
        234 => ['id_commune' => 249, 'id_city' => 26],
        235 => ['id_commune' => 252, 'id_city' => 28],
        236 => ['id_commune' => 250, 'id_city' => 39],
        237 => ['id_commune' => 259, 'id_city' => 7],
        238 => ['id_commune' => 255, 'id_city' => 3],
        239 => ['id_commune' => 260, 'id_city' => 11],
        240 => ['id_commune' => 258, 'id_city' => 17],
        241 => ['id_commune' => 257, 'id_city' => 18],
        242 => ['id_commune' => 264, 'id_city' => 341],
        243 => ['id_commune' => 261, 'id_city' => 44],
        244 => ['id_commune' => 262, 'id_city' => 40],
        245 => ['id_commune' => 256, 'id_city' => 42],
        246 => ['id_commune' => 263, 'id_city' => 2],
        247 => ['id_commune' => 243, 'id_city' => 32],
        248 => ['id_commune' => '#N/A', 'id_city' => '#N/A'],
        249 => ['id_commune' => 245, 'id_city' => 38],
        250 => ['id_commune' => 341, 'id_city' => 478],
        251 => ['id_commune' => 244, 'id_city' => 466],
        252 => ['id_commune' => 350, 'id_city' => 479],
        253 => ['id_commune' => 241, 'id_city' => 468],
        254 => ['id_commune' => 265, 'id_city' => 9],
        255 => ['id_commune' => 266, 'id_city' => 105],
        256 => ['id_commune' => 268, 'id_city' => 427],
        257 => ['id_commune' => 267, 'id_city' => 60],
        258 => ['id_commune' => '#N/A', 'id_city' => '#N/A'],
        259 => ['id_commune' => 273, 'id_city' => 253],
        260 => ['id_commune' => '#N/A', 'id_city' => '#N/A'],
        261 => ['id_commune' => 270, 'id_city' => 160],
        262 => ['id_commune' => 269, 'id_city' => 487],
        263 => ['id_commune' => 276, 'id_city' => 85],
        264 => ['id_commune' => 278, 'id_city' => 305],
        265 => ['id_commune' => 277, 'id_city' => 391],
        266 => ['id_commune' => 275, 'id_city' => 82],
        267 => ['id_commune' => 274, 'id_city' => 361],
        268 => ['id_commune' => 284, 'id_city' => 37],
        269 => ['id_commune' => 281, 'id_city' => 255],
        270 => ['id_commune' => 283, 'id_city' => 362],
        271 => ['id_commune' => 282, 'id_city' => 370],
        272 => ['id_commune' => 343, 'id_city' => 163],
        273 => ['id_commune' => 288, 'id_city' => 202],
        274 => ['id_commune' => 285, 'id_city' => 153],
        275 => ['id_commune' => 286, 'id_city' => 476],
        276 => ['id_commune' => 287, 'id_city' => 387],
        277 => ['id_commune' => 280, 'id_city' => 34],
        278 => ['id_commune' => 279, 'id_city' => 390],
        279 => ['id_commune' => 299, 'id_city' => 50],
        280 => ['id_commune' => 321, 'id_city' => 8],
        281 => ['id_commune' => 323, 'id_city' => 50],
        282 => ['id_commune' => 292, 'id_city' => 50],
        283 => ['id_commune' => 317, 'id_city' => 50],
        284 => ['id_commune' => 320, 'id_city' => 50],
        285 => ['id_commune' => 308, 'id_city' => 50],
        286 => ['id_commune' => 307, 'id_city' => 50],
        287 => ['id_commune' => 304, 'id_city' => 50],
        288 => ['id_commune' => 305, 'id_city' => 50],
        289 => ['id_commune' => 306, 'id_city' => 50],
        290 => ['id_commune' => 342, 'id_city' => 50],
        291 => ['id_commune' => 300, 'id_city' => 50],
        292 => ['id_commune' => 295, 'id_city' => 25],
        293 => ['id_commune' => 311, 'id_city' => 50],
        294 => ['id_commune' => 319, 'id_city' => 50],
        295 => ['id_commune' => 322, 'id_city' => 50],
        296 => ['id_commune' => 312, 'id_city' => 50],
        297 => ['id_commune' => 303, 'id_city' => 50],
        298 => ['id_commune' => 301, 'id_city' => 50],
        299 => ['id_commune' => 318, 'id_city' => 50],
        300 => ['id_commune' => 313, 'id_city' => 50],
        301 => ['id_commune' => 298, 'id_city' => 50],
        302 => ['id_commune' => 296, 'id_city' => 50],
        303 => ['id_commune' => 293, 'id_city' => 50],
        304 => ['id_commune' => 297, 'id_city' => 45],
        305 => ['id_commune' => 309, 'id_city' => 50],
        306 => ['id_commune' => 294, 'id_city' => 50],
        307 => ['id_commune' => 314, 'id_city' => 50],
        308 => ['id_commune' => 302, 'id_city' => 50],
        309 => ['id_commune' => 316, 'id_city' => 50],
        310 => ['id_commune' => 310, 'id_city' => 50],
        311 => ['id_commune' => 325, 'id_city' => 50],
        312 => ['id_commune' => 326, 'id_city' => 327],
        313 => ['id_commune' => 324, 'id_city' => 373],
        314 => ['id_commune' => 290, 'id_city' => 50],
        315 => ['id_commune' => 291, 'id_city' => 257],
        316 => ['id_commune' => 289, 'id_city' => 383],
        317 => ['id_commune' => 327, 'id_city' => 48],
        318 => ['id_commune' => 329, 'id_city' => 5],
        319 => ['id_commune' => 328, 'id_city' => 50],
        320 => ['id_commune' => 330, 'id_city' => 311],
        321 => ['id_commune' => 337, 'id_city' => 133],
        322 => ['id_commune' => 339, 'id_city' => 248],
        323 => ['id_commune' => 335, 'id_city' => 228],
        324 => ['id_commune' => 336, 'id_city' => 123],
        325 => ['id_commune' => 338, 'id_city' => 178],
        326 => ['id_commune' => 332, 'id_city' => 125],
        327 => ['id_commune' => 333, 'id_city' => 233],
        328 => ['id_commune' => 334, 'id_city' => 247],
        329 => ['id_commune' => 340, 'id_city' => 309],
        330 => ['id_commune' => 331, 'id_city' => 50],
        331 => ['id_commune' => 233, 'id_city' => 57],
        332 => ['id_commune' => 235, 'id_city' => 15],
        333 => ['id_commune' => 229, 'id_city' => 57],
        334 => ['id_commune' => 234, 'id_city' => 438],
        335 => ['id_commune' => 232, 'id_city' => 57],
        336 => ['id_commune' => 230, 'id_city' => 27],
        337 => ['id_commune' => 236, 'id_city' => 33],
        338 => ['id_commune' => 231, 'id_city' => 140],
        339 => ['id_commune' => 239, 'id_city' => 54],
        340 => ['id_commune' => 237, 'id_city' => 426],
        341 => ['id_commune' => 238, 'id_city' => 23],
        342 => ['id_commune' => 240, 'id_city' => 47],
        343 => ['id_commune' => 4, 'id_city' => 67],
        344 => ['id_commune' => 5, 'id_city' => 213],
        345 => ['id_commune' => 3, 'id_city' => 165],
        346 => ['id_commune' => 2, 'id_city' => 204],
    ];


    /**
     * Mapeo entre el ID de los giros en SimpleGestion y el ID en Covepa
     * 
     * id_giro_sg => id_covepa
     */
    const GIRO_MAPPING = [
        '11101' => '1000',
        '11102' => '1001',
        '11103' => '1002',
        '11104' => '1003',
        '11105' => '1004',
        '11106' => '1005',
        '11107' => '1006',
        '11108' => '1007',
        '11109' => '1008',
        '11110' => '1009',
        '11111' => '1010',
        '11200' => '1011',
        '11301' => '1012',
        '11302' => '1013',
        '11303' => '1014',
        '11304' => '1015',
        '11305' => '1016',
        '11306' => '1017',
        '11400' => '1018',
        '11500' => '1019',
        '11600' => '1020',
        '11901' => '1021',
        '11902' => '1022',
        '11903' => '1023',
        '12111' => '1024',
        '12112' => '1025',
        '12120' => '1026',
        '12200' => '1027',
        '12300' => '1028',
        '12400' => '1029',
        '12501' => '1030',
        '12502' => '1031',
        '12600' => '1032',
        '12700' => '1033',
        '12801' => '1034',
        '12802' => '1035',
        '12900' => '1036',
        '13000' => '1037',
        '14101' => '1038',
        '14102' => '1039',
        '14200' => '1040',
        '14300' => '1041',
        '14410' => '1042',
        '14420' => '1043',
        '14500' => '1044',
        '14601' => '1045',
        '14602' => '1046',
        '14901' => '1047',
        '14909' => '1048',
        '15000' => '1049',
        '16100' => '1050',
        '16200' => '1051',
        '16300' => '1052',
        '16400' => '1053',
        '17000' => '1054',
        '21001' => '1055',
        '21002' => '1056',
        '22000' => '1057',
        '23000' => '1058',
        '24001' => '1059',
        '24002' => '1060',
        '24003' => '1061',
        '24009' => '1062',
        '31110' => '1063',
        '31120' => '1064',
        '31130' => '1065',
        '31140' => '1066',
        '31200' => '1067',
        '32110' => '1068',
        '32120' => '1069',
        '32130' => '1070',
        '32140' => '1071',
        '32200' => '1072',
        '40000' => '1073',
        '51000' => '1074',
        '52000' => '1075',
        '61000' => '1076',
        '62000' => '1077',
        '71000' => '1078',
        '72100' => '1079',
        '72910' => '1080',
        '72991' => '1081',
        '72992' => '1082',
        '72999' => '1083',
        '81000' => '1084',
        '89110' => '1085',
        '89190' => '1086',
        '89200' => '1087',
        '89300' => '1088',
        '89900' => '1089',
        '91001' => '1090',
        '91002' => '1091',
        '99001' => '1092',
        '99002' => '1093',
        '101011' => '1094',
        '101019' => '1095',
        '101020' => '1096',
        '102010' => '1097',
        '102020' => '1098',
        '102030' => '1099',
        '102040' => '1100',
        '102050' => '1101',
        '102060' => '1102',
        '103000' => '1103',
        '104000' => '1104',
        '105000' => '1105',
        '106101' => '1106',
        '106102' => '1107',
        '106109' => '1108',
        '106200' => '1109',
        '107100' => '1110',
        '107200' => '1111',
        '107300' => '1112',
        '107400' => '1113',
        '107500' => '1114',
        '107901' => '1115',
        '107902' => '1116',
        '107903' => '1117',
        '107909' => '1118',
        '108000' => '1119',
        '110110' => '1120',
        '110120' => '1121',
        '110200' => '1122',
        '110300' => '1123',
        '110401' => '1124',
        '110402' => '1125',
        '120001' => '1126',
        '120009' => '1127',
        '131100' => '1128',
        '131200' => '1129',
        '131300' => '1130',
        '139100' => '1131',
        '139200' => '1132',
        '139300' => '1133',
        '139400' => '1134',
        '139900' => '1135',
        '141001' => '1136',
        '141002' => '1137',
        '141003' => '1138',
        '141004' => '1139',
        '142000' => '1140',
        '143000' => '1141',
        '151100' => '1142',
        '151200' => '1143',
        '152000' => '1144',
        '161000' => '1145',
        '162100' => '1146',
        '162200' => '1147',
        '162300' => '1148',
        '162900' => '1149',
        '170110' => '1150',
        '170190' => '1151',
        '170200' => '1152',
        '170900' => '1153',
        '181101' => '1154',
        '181109' => '1155',
        '181200' => '1156',
        '182000' => '1157',
        '191000' => '1158',
        '192000' => '1159',
        '201101' => '1160',
        '201109' => '1161',
        '201200' => '1162',
        '201300' => '1163',
        '202100' => '1164',
        '202200' => '1165',
        '202300' => '1166',
        '202901' => '1167',
        '202909' => '1168',
        '203000' => '1169',
        '210000' => '1170',
        '221100' => '1171',
        '221900' => '1172',
        '222000' => '1173',
        '231001' => '1174',
        '231002' => '1175',
        '231003' => '1176',
        '231009' => '1177',
        '239100' => '1178',
        '239200' => '1179',
        '239300' => '1180',
        '239400' => '1181',
        '239500' => '1182',
        '239600' => '1183',
        '239900' => '1184',
        '241000' => '1185',
        '242001' => '1186',
        '242002' => '1187',
        '242009' => '1188',
        '243100' => '1189',
        '243200' => '1190',
        '251100' => '1191',
        '251201' => '1192',
        '251209' => '1193',
        '251300' => '1194',
        '252000' => '1195',
        '259100' => '1196',
        '259200' => '1197',
        '259300' => '1198',
        '259900' => '1199',
        '261000' => '1200',
        '262000' => '1201',
        '263000' => '1202',
        '264000' => '1203',
        '265100' => '1204',
        '265200' => '1205',
        '266000' => '1206',
        '267000' => '1207',
        '268000' => '1208',
        '271000' => '1209',
        '272000' => '1210',
        '273100' => '1211',
        '273200' => '1212',
        '273300' => '1213',
        '274000' => '1214',
        '275000' => '1215',
        '279000' => '1216',
        '281100' => '1217',
        '281200' => '1218',
        '281300' => '1219',
        '281400' => '1220',
        '281500' => '1221',
        '281600' => '1222',
        '281700' => '1223',
        '281800' => '1224',
        '281900' => '1225',
        '282100' => '1226',
        '282200' => '1227',
        '282300' => '1228',
        '282400' => '1229',
        '282500' => '1230',
        '282600' => '1231',
        '282900' => '1232',
        '291000' => '1233',
        '292000' => '1234',
        '293000' => '1235',
        '301100' => '1236',
        '301200' => '1237',
        '302000' => '1238',
        '303000' => '1239',
        '304000' => '1240',
        '309100' => '1241',
        '309200' => '1242',
        '309900' => '1243',
        '310001' => '1244',
        '310009' => '1245',
        '321100' => '1246',
        '321200' => '1247',
        '322000' => '1248',
        '323000' => '1249',
        '324000' => '1250',
        '325001' => '1251',
        '325009' => '1252',
        '329000' => '1253',
        '331100' => '1254',
        '331201' => '1255',
        '331202' => '1256',
        '331203' => '1257',
        '331204' => '1258',
        '331209' => '1259',
        '331301' => '1260',
        '331309' => '1261',
        '331400' => '1262',
        '331501' => '1263',
        '331502' => '1264',
        '331509' => '1265',
        '331900' => '1266',
        '332000' => '1267',
        '351011' => '1268',
        '351012' => '1269',
        '351019' => '1270',
        '351020' => '1271',
        '351030' => '1272',
        '352010' => '1273',
        '352020' => '1274',
        '353001' => '1275',
        '353002' => '1276',
        '360000' => '1277',
        '370000' => '1278',
        '381100' => '1279',
        '381200' => '1280',
        '382100' => '1281',
        '382200' => '1282',
        '383001' => '1283',
        '383002' => '1284',
        '383003' => '1285',
        '383009' => '1286',
        '390000' => '1287',
        '410010' => '1288',
        '410020' => '1289',
        '421000' => '1290',
        '422000' => '1291',
        '429000' => '1292',
        '431100' => '1293',
        '431200' => '1294',
        '432100' => '1295',
        '432200' => '1296',
        '432900' => '1297',
        '433000' => '1298',
        '439000' => '1299',
        '451001' => '1300',
        '451002' => '1301',
        '452001' => '1302',
        '452002' => '1303',
        '453000' => '1304',
        '454001' => '1305',
        '454002' => '1306',
        '454003' => '1307',
        '461001' => '1308',
        '461002' => '1309',
        '461009' => '1310',
        '462010' => '1311',
        '462020' => '1312',
        '462090' => '1313',
        '463011' => '1314',
        '463012' => '1315',
        '463013' => '1316',
        '463014' => '1317',
        '463019' => '1318',
        '463020' => '1319',
        '463030' => '1320',
        '464100' => '1321',
        '464901' => '1322',
        '464902' => '1323',
        '464903' => '1324',
        '464904' => '1325',
        '464905' => '1326',
        '464906' => '1327',
        '464907' => '1328',
        '464908' => '1329',
        '464909' => '1330',
        '465100' => '1331',
        '465200' => '1332',
        '465300' => '1333',
        '465901' => '1334',
        '465902' => '1335',
        '465903' => '1336',
        '465904' => '1337',
        '465905' => '1338',
        '465909' => '1339',
        '466100' => '1340',
        '466200' => '1341',
        '466301' => '1342',
        '466302' => '1343',
        '466901' => '1344',
        '466902' => '1345',
        '466909' => '1346',
        '469000' => '1347',
        '471100' => '1348',
        '471910' => '1349',
        '471990' => '1350',
        '472101' => '1351',
        '472102' => '1352',
        '472103' => '1353',
        '472104' => '1354',
        '472105' => '1355',
        '472109' => '1356',
        '472200' => '1357',
        '472300' => '1358',
        '473000' => '1359',
        '474100' => '1360',
        '474200' => '1361',
        '475100' => '1362',
        '475201' => '1363',
        '475202' => '1364',
        '475203' => '1365',
        '475300' => '1366',
        '475901' => '1367',
        '475902' => '1368',
        '475909' => '1369',
        '476101' => '1370',
        '476102' => '1371',
        '476103' => '1372',
        '476200' => '1373',
        '476301' => '1374',
        '476302' => '1375',
        '476309' => '1376',
        '476400' => '1377',
        '477101' => '1378',
        '477102' => '1379',
        '477103' => '1380',
        '477201' => '1381',
        '477202' => '1382',
        '477203' => '1383',
        '477310' => '1384',
        '477391' => '1385',
        '477392' => '1386',
        '477393' => '1387',
        '477394' => '1388',
        '477395' => '1389',
        '477396' => '1390',
        '477397' => '1391',
        '477398' => '1392',
        '477399' => '1393',
        '477401' => '1394',
        '477402' => '1395',
        '477409' => '1396',
        '478100' => '1397',
        '478200' => '1398',
        '478900' => '1399',
        '479100' => '1400',
        '479901' => '1401',
        '479902' => '1402',
        '479903' => '1403',
        '479909' => '1404',
        '491100' => '1405',
        '491200' => '1406',
        '492110' => '1407',
        '492120' => '1408',
        '492130' => '1409',
        '492190' => '1410',
        '492210' => '1411',
        '492220' => '1412',
        '492230' => '1413',
        '492240' => '1414',
        '492250' => '1415',
        '492290' => '1416',
        '492300' => '1417',
        '493010' => '1418',
        '493020' => '1419',
        '493090' => '1420',
        '501100' => '1421',
        '501200' => '1422',
        '502100' => '1423',
        '502200' => '1424',
        '511000' => '1425',
        '512000' => '1426',
        '521001' => '1427',
        '521009' => '1428',
        '522110' => '1429',
        '522120' => '1430',
        '522130' => '1431',
        '522190' => '1432',
        '522200' => '1433',
        '522300' => '1434',
        '522400' => '1435',
        '522910' => '1436',
        '522920' => '1437',
        '522990' => '1438',
        '531000' => '1439',
        '532000' => '1440',
        '551001' => '1441',
        '551002' => '1442',
        '551003' => '1443',
        '551009' => '1444',
        '552000' => '1445',
        '559001' => '1446',
        '559009' => '1447',
        '561000' => '1448',
        '562100' => '1449',
        '562900' => '1450',
        '563001' => '1451',
        '563009' => '1452',
        '581100' => '1453',
        '581200' => '1454',
        '581300' => '1455',
        '581900' => '1456',
        '582000' => '1457',
        '591100' => '1458',
        '591200' => '1459',
        '591300' => '1460',
        '591400' => '1461',
        '592000' => '1462',
        '601000' => '1463',
        '602000' => '1464',
        '611010' => '1465',
        '611020' => '1466',
        '611030' => '1467',
        '611090' => '1468',
        '612010' => '1469',
        '612020' => '1470',
        '612030' => '1471',
        '612090' => '1472',
        '613010' => '1473',
        '613020' => '1474',
        '613090' => '1475',
        '619010' => '1476',
        '619090' => '1477',
        '620100' => '1478',
        '620200' => '1479',
        '620900' => '1480',
        '631100' => '1481',
        '631200' => '1482',
        '639100' => '1483',
        '639900' => '1484',
        '641100' => '1485',
        '641910' => '1486',
        '641990' => '1487',
        '642000' => '1488',
        '643000' => '1489',
        '649100' => '1490',
        '649201' => '1491',
        '649202' => '1492',
        '649203' => '1493',
        '649209' => '1494',
        '649900' => '1495',
        '651100' => '1496',
        '651210' => '1497',
        '651220' => '1498',
        '652000' => '1499',
        '653000' => '1500',
        '661100' => '1501',
        '661201' => '1502',
        '661202' => '1503',
        '661203' => '1504',
        '661204' => '1505',
        '661209' => '1506',
        '661901' => '1507',
        '661902' => '1508',
        '661903' => '1509',
        '661904' => '1510',
        '661909' => '1511',
        '662100' => '1512',
        '662200' => '1513',
        '662900' => '1514',
        '663010' => '1515',
        '663091' => '1516',
        '663092' => '1517',
        '663093' => '1518',
        '663094' => '1519',
        '663099' => '1520',
        '681011' => '1521',
        '681012' => '1522',
        '681020' => '1523',
        '682000' => '1524',
        '691001' => '1525',
        '691002' => '1526',
        '691003' => '1527',
        '691004' => '1528',
        '691009' => '1529',
        '692000' => '1530',
        '701000' => '1531',
        '702000' => '1532',
        '711001' => '1533',
        '711002' => '1534',
        '711003' => '1535',
        '712001' => '1536',
        '712009' => '1537',
        '721000' => '1538',
        '722000' => '1539',
        '731001' => '1540',
        '731002' => '1541',
        '732000' => '1542',
        '741001' => '1543',
        '741002' => '1544',
        '741009' => '1545',
        '742001' => '1546',
        '742002' => '1547',
        '742003' => '1548',
        '749001' => '1549',
        '749002' => '1550',
        '749003' => '1551',
        '749004' => '1552',
        '749009' => '1553',
        '750001' => '1554',
        '750002' => '1555',
        '771000' => '1556',
        '772100' => '1557',
        '772200' => '1558',
        '772900' => '1559',
        '773001' => '1560',
        '773002' => '1561',
        '773003' => '1562',
        '773009' => '1563',
        '774000' => '1564',
        '781000' => '1565',
        '782000' => '1566',
        '783000' => '1567',
        '791100' => '1568',
        '791200' => '1569',
        '799000' => '1570',
        '801001' => '1571',
        '801002' => '1572',
        '801003' => '1573',
        '802000' => '1574',
        '803000' => '1575',
        '811000' => '1576',
        '812100' => '1577',
        '812901' => '1578',
        '812909' => '1579',
        '813000' => '1580',
        '821100' => '1581',
        '821900' => '1582',
        '822000' => '1583',
        '823000' => '1584',
        '829110' => '1585',
        '829120' => '1586',
        '829200' => '1587',
        '829900' => '1588',
        '841100' => '1589',
        '841200' => '1590',
        '841300' => '1591',
        '842100' => '1592',
        '842200' => '1593',
        '842300' => '1594',
        '843010' => '1595',
        '843020' => '1596',
        '843090' => '1597',
        '850011' => '1598',
        '850012' => '1599',
        '850021' => '1600',
        '850022' => '1601',
        '853110' => '1602',
        '853120' => '1603',
        '853201' => '1604',
        '853202' => '1605',
        '854100' => '1606',
        '854200' => '1607',
        '854901' => '1608',
        '854902' => '1609',
        '854909' => '1610',
        '855000' => '1611',
        '861010' => '1612',
        '861020' => '1613',
        '862010' => '1614',
        '862021' => '1615',
        '862022' => '1616',
        '862031' => '1617',
        '862032' => '1618',
        '869010' => '1619',
        '869091' => '1620',
        '869092' => '1621',
        '871000' => '1622',
        '872000' => '1623',
        '873000' => '1624',
        '879000' => '1625',
        '881000' => '1626',
        '889000' => '1627',
        '900001' => '1628',
        '900002' => '1629',
        '900003' => '1630',
        '900004' => '1631',
        '900009' => '1632',
        '910100' => '1633',
        '910200' => '1634',
        '910300' => '1635',
        '920010' => '1636',
        '920090' => '1637',
        '931101' => '1638',
        '931102' => '1639',
        '931109' => '1640',
        '931201' => '1641',
        '931209' => '1642',
        '931901' => '1643',
        '931909' => '1644',
        '932100' => '1645',
        '932901' => '1646',
        '932909' => '1647',
        '941100' => '1648',
        '941200' => '1649',
        '942000' => '1650',
        '949100' => '1651',
        '949200' => '1652',
        '949901' => '1653',
        '949902' => '1654',
        '949903' => '1655',
        '949904' => '1656',
        '949909' => '1657',
        '951100' => '1658',
        '951200' => '1659',
        '952100' => '1660',
        '952200' => '1661',
        '952300' => '1662',
        '952400' => '1663',
        '952900' => '1664',
        '960100' => '1665',
        '960200' => '1666',
        '960310' => '1667',
        '960320' => '1668',
        '960901' => '1669',
        '960902' => '1670',
        '960909' => '1671',
        '970000' => '1672',
        '990000' => '1673',
    ];

    public static function getPaymentArray(Order $order) : array
    {
        $payment = $order->order_payments->first(); 
        $rut = rutWithoutDV($order->uid);

        $rutWithoutDV = rutWithoutDV($order->uid);
        $address = $order->json_value['addressShipping'];
        $invoiceAddress = $order->json_value['addressInvoice']->status ? $order->json_value['addressInvoice'] : $address; 
        $invoiceRut = empty($invoiceAddress->uid) ?  $rutWithoutDV : rutWithoutDV($invoiceAddress->uid);

        if ($payment->method === 'tbkplus') {
            $details = json_decode($payment->json_in, true);
            $authCode = (int) $details['data']['detailOutput']['authorizationCode'];
            $quotes = $details['data']['detailOutput']['sharesNumber'] == 0 ? 1 : $details['data']['detailOutput']['sharesNumber'];
            $paymentType = self::TYPE_PAYMENT_MAPPING[$details['data']['detailOutput']['paymentTypeCode']];   
        }

        return [
            [ 
                "FORPGO_CODIGO" => $paymentType,
                "VTAPGO_CORREL" => 1,
                "VTAPGO_MONPGO" => (int) $order->total,
                "VTAPGO_NCUOTA" => $quotes,
                "VTAPGO_FECUOT" => Carbon::now()->format('d/m/Y'), 
                "VTAPGO_NRDCPG" => $authCode,
                "SUJETO_RUTDUE" => rutWithoutDV($order->getInvoiceRut()),
                "SUJETO_RUTSUJ" => rutWithoutDV($order->getInvoiceRut()), // Rut del documento de venta
            ]
        ];
    }
}